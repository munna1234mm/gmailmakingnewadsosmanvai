<!DOCTYPE html>
<html lang="bn">

<head>
    <!-- HilltopAds Verification Code -->
    <meta name="6fedacbba332ed7faf409aa3353180401f99cbb6" content="6fedacbba332ed7faf409aa3353180401f99cbb6" />

    <!-- Monetag Ads Verification Code -->
    <meta name="monetag" content="38007a77501da08e5fb83dbeb9bc8c24">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gmail Father - Premium Clean Edition</title>

    <!-- External Resources -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&family=Manrope:wght@400;500;700;800&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#34d399",
                        "primary-dark": "#10b981",
                        "accent-gold": "#fbbf24",
                        "background-light": "#ffffff",
                        "surface-light": "#f0fdfa",
                        "border-light": "#ccfbf1",
                    },
                    fontFamily: { "display": ["Manrope", "Hind Siliguri", "sans-serif"] }
                }
            }
        }
    </script>
    <!-- Happy Tag In-Page Push Ads -->
    <script>(function (s) { s.dataset.zone = '10646261', s.src = 'https://nap5k.com/tag.min.js' })([document.documentElement, document.body].filter(Boolean).pop().appendChild(document.createElement('script')))</script>

    <style type="text/tailwindcss">
        body { font-family: 'Manrope', 'Hind Siliguri', sans-serif; background-color: #ffffff; -webkit-tap-highlight-color: transparent; }
        .green-gradient { background: linear-gradient(135deg, #34d399 0%, #10b981 100%); }
        .view-section { display: none; }
        .view-active { display: flex; flex-direction: column; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #34d399; border-radius: 10px; }
    </style>
</head>

<body class="bg-white text-slate-900 min-h-screen select-none">

    <!-- Loading Screen -->
    <div id="loading-screen"
        class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="flex flex-col items-center gap-4">
            <div class="w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"></div>
            <p class="text-primary text-xs font-bold uppercase tracking-widest animate-pulse">Gmail Father</p>
        </div>
    </div>

    <!-- Auth Section -->
    <div id="auth-shell" class="hidden min-h-screen flex flex-col items-center justify-center p-6 bg-surface-light">
        <div class="w-full max-w-[420px] space-y-8 animate-in fade-in">
            <div class="text-center space-y-4">
                <div
                    class="w-24 h-24 mx-auto rounded-3xl overflow-hidden shadow-xl border-4 border-white relative group">
                    <img src="https://i.ibb.co.com/rKc5Qm12/photo-2026-02-20-02-46-22.jpg" alt="Logo"
                        class="w-full h-full object-cover">
                </div>
                <h1 class="text-3xl font-black text-primary">Gmail Father</h1>
                <p id="auth-desc" class="text-slate-500 text-sm font-medium">আপনার অ্যাকাউন্ট তৈরি করার বিশ্বস্ত অ্যাপ
                </p>
            </div>

            <div class="bg-white p-8 rounded-[2.5rem] shadow-2xl border border-border-light">
                <h2 id="auth-title" class="text-2xl font-bold text-center mb-8 text-slate-800">লগইন করুন</h2>

                <div id="auth-error"
                    class="hidden mb-6 p-4 bg-red-50 border border-red-100 rounded-xl text-red-600 text-sm flex gap-2">
                    <i data-lucide="alert-circle" class="shrink-0 w-5 h-5"></i>
                    <p id="error-message"></p>
                </div>

                <form id="auth-form" class="space-y-5">
                    <div id="signup-fields" class="hidden space-y-2">
                        <label class="text-xs font-bold uppercase text-slate-400 ml-1">আপনার নাম</label>
                        <input id="auth-name" type="text"
                            class="w-full h-14 px-4 bg-slate-50 border border-slate-100 rounded-2xl outline-none focus:border-primary font-bold transition-all"
                            placeholder="নাম লিখুন">
                    </div>
                    <div class="space-y-2">
                        <label class="text-xs font-bold uppercase text-slate-400 ml-1">ইমেইল ঠিকানা</label>
                        <input id="auth-email" type="email" required
                            class="w-full h-14 px-4 bg-slate-50 border border-slate-100 rounded-2xl outline-none focus:border-primary font-bold transition-all"
                            placeholder="example@mail.com">
                    </div>
                    <div class="space-y-2">
                        <label class="text-xs font-bold uppercase text-slate-400 ml-1">পাসওয়ার্ড</label>
                        <div class="relative">
                            <input id="auth-password" type="password" required
                                class="w-full h-14 px-4 bg-slate-50 border border-slate-100 rounded-2xl outline-none focus:border-primary font-bold transition-all"
                                placeholder="••••••••">
                            <button type="button" onclick="window.togglePassword()"
                                class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-primary transition-colors">
                                <i id="eye-icon" data-lucide="eye" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                    <button type="submit" id="auth-submit-btn"
                        class="w-full h-14 green-gradient text-white font-bold rounded-2xl shadow-lg transition-all active:scale-95 flex items-center justify-center">
                        <span id="auth-btn-text">প্রবেশ করুন</span>
                    </button>
                </form>

                <div class="mt-8 text-center">
                    <button onclick="window.toggleAuthMode()" id="auth-toggle-btn"
                        class="text-sm font-bold text-slate-500 hover:text-primary transition-colors">
                        অ্যাকাউন্ট নেই? নতুন তৈরি করুন
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- App Shell -->
    <div id="app-shell" class="hidden min-h-screen flex flex-col relative overflow-hidden bg-white">
        <header id="main-header"
            class="px-6 py-4 flex items-center justify-between sticky top-0 z-50 bg-white/90 backdrop-blur-xl border-b border-slate-100">
            <div class="flex items-center gap-2">
                <img src="https://i.ibb.co.com/rKc5Qm12/photo-2026-02-20-02-46-22.jpg" alt="Logo"
                    class="w-9 h-9 rounded-xl shadow-sm border border-slate-100">
                <h1 class="text-base font-black text-slate-800 tracking-tight">Gmail Father</h1>
            </div>

            <div class="bg-primary/10 px-3 py-1.5 rounded-2xl border border-primary/20 flex items-center gap-2">
                <i data-lucide="database" class="w-3.5 h-3.5 text-primary fill-current"></i>
                <span id="header-credits" class="text-sm font-black text-primary">0</span>
            </div>
        </header>

        <main id="main-content" class="flex-1 overflow-y-auto custom-scrollbar">
            <!-- VIEW: Browser -->
            <div id="view-browser" class="view-section items-center justify-center px-6 py-12 fade-in">
                <div class="mb-10 w-48 h-48 bg-primary/5 rounded-full flex items-center justify-center relative">
                    <div class="absolute inset-0 bg-primary/10 blur-3xl rounded-full"></div>
                    <i data-lucide="globe" class="text-primary w-20 h-20 relative z-10"></i>
                </div>
                <h2 id="gmail-tool-title" class="text-2xl font-black mb-4 text-slate-800">Gmail Free Tool</h2>
                <p class="text-slate-500 text-center mb-8 text-sm leading-relaxed">জিমেইল তৈরি করার জন্য নিচের বাটনে
                    ক্লিক করে ব্রাউজার খুলুন। প্রতি জিমেইল ক্রিয়েশনে পাবেন আকর্ষণীয় রিওয়ার্ড।</p>
                <button onclick="window.handleOpenBrowser()"
                    class="w-full max-w-sm green-gradient text-white py-4 rounded-3xl font-bold shadow-xl active:scale-95 transition-all hover:shadow-primary/40">Gmail
                    Create</button>
            </div>

            <!-- VIEW: Home (Earn) -->
            <div id="view-home" class="view-section px-6 py-8 fade-in">
                <div
                    class="green-gradient rounded-[2.5rem] p-8 text-white text-center shadow-xl mb-12 relative overflow-hidden">
                    <div class="absolute -right-6 -top-6 opacity-10"><i data-lucide="zap"
                            class="w-32 h-32 text-white"></i></div>
                    <p class="text-[10px] font-black uppercase tracking-[0.3em] mb-2 opacity-80 font-display">আপনার
                        ব্যালেন্স</p>
                    <h2 id="home-credits" class="text-6xl font-black tracking-tighter">0</h2>
                </div>
                <div class="text-center relative">
                    <h2 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-6 font-display">বোনাস
                        সেন্টার</h2>
                    <div class="relative w-full max-w-xs mx-auto">
                        <button onclick="window.handleWatchAd()" id="watch-ad-btn"
                            class="w-64 h-64 mx-auto rounded-full bg-white border-8 border-slate-50 flex flex-col items-center justify-center gap-2 shadow-2xl transition-all active:scale-95 group relative z-10">
                            <div class="bg-primary/10 p-5 rounded-full group-hover:bg-primary/20 transition-colors">
                                <i data-lucide="gift" class="text-primary w-12 h-12"></i>
                            </div>
                            <span class="font-black text-slate-800 text-xl tracking-tight">পয়েন্ট নিন</span>
                            <span id="earn-btn-sub" class="text-xs font-bold text-primary uppercase tracking-widest">+১
                                ক্রেডিট</span>
                        </button>
                        <div class="absolute inset-0 bg-primary/20 blur-3xl rounded-full animate-pulse"></div>
                    </div>
                    <p id="ad-status"
                        class="text-[10px] text-slate-400 mt-6 uppercase font-bold tracking-widest font-display">সরাসরি
                        ক্রেডিট সংগ্রহ করুন</p>
                </div>
            </div>

            <!-- VIEW: Leaderboard -->
            <div id="view-leaderboard" class="view-section fade-in">
                <div class="px-6 pt-8 pb-4">
                    <h1 id="leader-title" class="text-2xl font-black text-slate-800 mb-2">লিডারবোর্ড</h1>
                    <p class="text-xs text-slate-400 font-bold uppercase tracking-wider mb-6">সেরা ১০০ জন ব্যবহারকারী
                    </p>

                    <!-- Podium for Top 3 -->
                    <div
                        class="flex items-end justify-center gap-3 mb-10 bg-slate-50/50 p-4 rounded-[2rem] border border-slate-100">
                        <!-- Rank 2 -->
                        <div class="flex flex-col items-center flex-1">
                            <div class="relative mb-2">
                                <span
                                    class="absolute -top-2 left-1/2 -translate-x-1/2 bg-slate-400 text-white text-[9px] font-black px-2 py-0.5 rounded-full">#2</span>
                                <div class="w-16 h-16 rounded-2xl border-2 border-slate-200 overflow-hidden shadow-md">
                                    <img src="https://i.pravatar.cc/150?u=2" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-600 truncate w-20 text-center">শফিক_০৭</p>
                            <p class="text-[9px] font-black text-primary">৮৪,২০০</p>
                        </div>
                        <!-- Rank 1 -->
                        <div class="flex flex-col items-center flex-1 scale-110 -translate-y-2">
                            <div class="relative mb-2">
                                <i data-lucide="crown"
                                    class="absolute -top-6 left-1/2 -translate-x-1/2 text-accent-gold w-6 h-6 fill-current"></i>
                                <div
                                    class="w-20 h-20 rounded-2xl border-4 border-accent-gold overflow-hidden shadow-xl ring-4 ring-accent-gold/10">
                                    <img src="https://i.pravatar.cc/150?u=1" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <p class="text-[11px] font-black text-slate-800 uppercase text-center">রাইহান খান</p>
                            <p class="text-[10px] font-black text-accent-gold">১,২৫,০০০</p>
                        </div>
                        <!-- Rank 3 -->
                        <div class="flex flex-col items-center flex-1">
                            <div class="relative mb-2">
                                <span
                                    class="absolute -top-2 left-1/2 -translate-x-1/2 bg-orange-400 text-white text-[9px] font-black px-2 py-0.5 rounded-full">#3</span>
                                <div class="w-16 h-16 rounded-2xl border-2 border-slate-200 overflow-hidden shadow-md">
                                    <img src="https://i.pravatar.cc/150?u=3" class="w-full h-full object-cover">
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-600 truncate w-20 text-center">আবির_বিডি</p>
                            <p class="text-[9px] font-black text-primary">৭২,৫০০</p>
                        </div>
                    </div>
                </div>

                <div id="leaderboard-list" class="px-6 space-y-3 pb-44">
                    <!-- Dynamic Users from Rank 4 to 100 -->
                </div>
            </div>

            <!-- VIEW: Profile -->
            <div id="view-profile" class="view-section px-6 py-8 fade-in">
                <div class="flex flex-col items-center mb-8">
                    <div class="relative mb-6">
                        <div class="w-32 h-32 rounded-[2rem] p-1 green-gradient shadow-2xl">
                            <div
                                class="w-full h-full rounded-[1.8rem] border-4 border-white overflow-hidden bg-slate-50 flex items-center justify-center">
                                <img src="https://i.ibb.co.com/rKc5Qm12/photo-2026-02-20-02-46-22.jpg"
                                    class="w-full h-full object-cover">
                            </div>
                        </div>
                        <div
                            class="absolute -bottom-3 left-1/2 -translate-x-1/2 green-gradient text-white text-[10px] font-black px-5 py-1.5 rounded-full uppercase tracking-widest shadow-xl border-2 border-white whitespace-nowrap">
                            Level <span id="profile-level">24</span></div>
                    </div>
                    <h2 id="profile-name"
                        class="text-2xl font-black tracking-tight text-slate-800 text-center uppercase tracking-widest font-display">
                        ...</h2>
                    <p id="profile-email"
                        class="text-slate-400 font-bold text-[10px] uppercase tracking-widest text-center mt-1">
                        EMAIL@EXAMPLE.COM</p>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-8">
                    <div class="bg-slate-50 p-5 rounded-3xl border border-slate-100 text-center">
                        <p id="total-credits-label"
                            class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">মোট ক্রেডিট</p>
                        <p id="stats-credits" class="text-lg font-black text-primary">0</p>
                    </div>
                    <div class="bg-slate-50 p-5 rounded-3xl border border-slate-100 text-center">
                        <p id="activity-label"
                            class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">অ্যাক্টিভিটি</p>
                        <p id="stats-ads" class="text-lg font-black text-slate-800">0</p>
                    </div>
                </div>

                <div class="space-y-3">
                    <!-- Language Setting -->
                    <div class="w-full p-5 bg-white border border-slate-100 rounded-2xl shadow-sm">
                        <div class="flex items-center gap-4 mb-4">
                            <div
                                class="w-10 h-10 rounded-xl bg-primary/10 text-primary flex items-center justify-center">
                                <i data-lucide="settings" class="w-5 h-5"></i>
                            </div>
                            <span class="font-bold text-slate-700">Account Settings</span>
                        </div>
                        <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3">Language / ভাষা
                            / Язык</p>
                        <div class="flex items-center gap-2">
                            <button onclick="window.setLang('bn')" id="lang-bn"
                                class="flex-1 py-2 text-xs font-black rounded-xl border border-primary/30 bg-primary/10 text-primary transition-all">🇧🇩
                                বাংলা</button>
                            <button onclick="window.setLang('en')" id="lang-en"
                                class="flex-1 py-2 text-xs font-black rounded-xl border border-slate-200 text-slate-400 transition-all">🇬🇧
                                English</button>
                            <button onclick="window.setLang('ru')" id="lang-ru"
                                class="flex-1 py-2 text-xs font-black rounded-xl border border-slate-200 text-slate-400 transition-all">🇷🇺
                                Русский</button>
                        </div>
                    </div>
                    <button id="logout-btn" onclick="window.handleLogout()"
                        class="w-full py-5 rounded-3xl text-red-500 bg-red-50 font-black uppercase text-xs tracking-widest border border-red-100 active:scale-95 transition-all shadow-sm">লগআউট</button>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav
            class="fixed bottom-0 w-full bg-white/95 border-t border-slate-100 px-6 pt-3 pb-10 flex justify-around shadow-2xl backdrop-blur-xl z-50">
            <button onclick="window.showView('home')"
                class="nav-btn flex flex-col items-center gap-1.5 text-slate-300 group transition-all" data-view="home">
                <i data-lucide="zap" class="w-6 h-6 transition-transform group-active:scale-90"></i>
                <span id="nav-earn-text"
                    class="nav-earn text-[9px] font-bold uppercase tracking-wider font-display">EARN</span>
            </button>
            <button onclick="window.showView('browser')"
                class="nav-btn flex flex-col items-center gap-1.5 text-slate-300 group transition-all"
                data-view="browser">
                <i data-lucide="layout-grid" class="w-6 h-6 transition-transform group-active:scale-90"></i>
                <span id="nav-work-text"
                    class="nav-work text-[9px] font-bold uppercase tracking-wider font-display">WORK</span>
            </button>
            <button onclick="window.showView('leaderboard')"
                class="nav-btn flex flex-col items-center gap-1.5 text-slate-300 group transition-all"
                data-view="leaderboard">
                <i data-lucide="trophy" class="w-6 h-6 transition-transform group-active:scale-90"></i>
                <span id="nav-rank-text"
                    class="nav-rank text-[9px] font-bold uppercase tracking-wider font-display">RANK</span>
            </button>
            <button onclick="window.showView('profile')"
                class="nav-btn flex flex-col items-center gap-1.5 text-slate-300 group transition-all"
                data-view="profile">
                <i data-lucide="user" class="w-6 h-6 transition-transform group-active:scale-90"></i>
                <span id="nav-user-text"
                    class="nav-user text-[9px] font-bold uppercase tracking-wider font-display">USER</span>
            </button>
        </nav>
    </div>

    <!-- Script Section -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, updateProfile, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, updateDoc, onSnapshot, getDoc, increment } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        // Environment Variables
        const appId = typeof __app_id !== 'undefined' ? __app_id : "gmail-father-v3";
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "AIzaSyAmtDEw41p1POsK-8qWQM_f3PzBFjFBHxc",
            authDomain: "gen-lang-client-0199662561.firebaseapp.com",
            databaseURL: "https://gen-lang-client-0199662561-default-rtdb.firebaseio.com",
            projectId: "gen-lang-client-0199662561",
            storageBucket: "gen-lang-client-0199662561.firebasestorage.app",
            messagingSenderId: "940475130557",
            appId: "1:940475130557:web:486451c872fdff0abecdd4",
            measurementId: "G-488L7913ES"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global State
        let isSignupMode = false;

        // --- Logic Functions ---

        window.toggleAuthMode = () => {
            isSignupMode = !isSignupMode;
            const signupFields = document.getElementById('signup-fields');
            signupFields.classList.toggle('hidden', !isSignupMode);
            document.getElementById('auth-title').textContent = isSignupMode ? "অ্যাকাউন্ট খুলুন" : "লগইন করুন";
            document.getElementById('auth-btn-text').textContent = isSignupMode ? "রেজিস্ট্রেশন" : "প্রবেশ করুন";
            document.getElementById('auth-toggle-btn').textContent = isSignupMode ? "ইতিমধ্যে অ্যাকাউন্ট আছে? লগইন করুন" : "অ্যাকাউন্ট নেই? নতুন তৈরি করুন";
        };

        window.togglePassword = () => {
            const input = document.getElementById('auth-password');
            const icon = document.getElementById('eye-icon');
            const isPass = input.type === 'password';
            input.type = isPass ? 'text' : 'password';
            icon.setAttribute('data-lucide', isPass ? 'eye-off' : 'eye');
            lucide.createIcons();
        };

        const updateAdStatus = (status) => {
            const el = document.getElementById('ad-status');
            if (el) el.textContent = status;
        };

        window.handleWatchAd = () => {
            const btn = document.getElementById('watch-ad-btn');
            if (!auth.currentUser) {
                alert("Please login first!");
                return;
            }
            btn.disabled = true;

            // Open ad link
            window.open('https://omg10.com/4/10190531', '_blank');
            updateAdStatus("5 second wait...");

            let countdown = 5;
            const timer = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    updateAdStatus(countdown + " seconds left...");
                } else {
                    clearInterval(timer);
                    updateAdStatus("Adding credit...");
                }
            }, 1000);

            setTimeout(async () => {
                try {
                    const uid = auth.currentUser.uid;
                    const userDocRef = doc(db, 'artifacts', appId, 'users', uid, 'profile', 'info');
                    // Use increment for atomic add
                    await setDoc(userDocRef, {
                        credits: increment(1),
                        adsWatched: increment(1)
                    }, { merge: true });
                    updateAdStatus("+1 Credit Added!");
                    console.log("Credit added successfully for uid:", uid);
                } catch (e) {
                    console.error("Credit update failed:", e.code, e.message);
                    updateAdStatus("Error: " + e.message);
                } finally {
                    setTimeout(() => {
                        btn.disabled = false;
                        updateAdStatus("Click to earn credits");
                    }, 2000);
                }
            }, 5000);
        };

        window.handleOpenBrowser = async () => {
            if (!auth.currentUser) return;
            try {
                const userDocRef = doc(db, 'artifacts', appId, 'users', auth.currentUser.uid, 'profile', 'info');
                const snap = await getDoc(userDocRef);
                const credits = snap.exists() ? (snap.data().credits || 0) : 0;
                if (credits >= 2) {
                    // Deduct 2 credits atomically
                    await setDoc(userDocRef, {
                        credits: increment(-2)
                    }, { merge: true });
                    window.open('https://accounts.google.com/signup', '_blank');
                } else {
                    alert("Gmail তৈরি করতে কমপক্ষে ২ ক্রেডিট লাগবে।\nআপনার বর্তমান ক্রেডিট: " + credits);
                }
            } catch (e) {
                console.error(e);
                alert("Error: " + e.message);
            }
        };

        const generateDemoUsers = () => {
            const list = document.getElementById('leaderboard-list');
            if (!list || list.children.length > 0) return;

            const names = ["Abir", "Rifat", "Sujon", "Hridoy", "Nila", "Sumaiya", "Tarek", "Faysal", "Mim", "Sakib", "Joy", "Isha", "Milon", "Tanvir", "Sonia", "Kajal", "Imran", "Arif", "Nasir", "Sabina", "Emon", "Rakib", "Faruk", "Bristi", "Jannat", "Sabbir", "Nabila", "Fatema", "Robi", "Asif"];

            for (let i = 4; i <= 100; i++) {
                const name = names[Math.floor(Math.random() * names.length)] + "_" + Math.floor(Math.random() * 999);
                const credits = 70000 - (i * 650) + Math.floor(Math.random() * 300);

                const item = document.createElement('div');
                item.className = "flex items-center p-4 rounded-2xl bg-white border border-slate-100 shadow-sm transition-all hover:border-primary/20 group fade-in";
                item.innerHTML = `
                    <span class="text-sm font-black text-slate-300 w-8 font-display group-hover:text-primary transition-colors">${i < 10 ? '0' + i : i}</span>
                    <div class="w-11 h-11 rounded-xl bg-slate-100 mr-4 overflow-hidden border border-slate-50 shadow-inner flex items-center justify-center">
                        <img src="https://i.pravatar.cc/100?u=${i}" class="object-cover w-full h-full opacity-80 group-hover:opacity-100 transition-all">
                    </div>
                    <div class="flex-1 text-left">
                        <p class="font-black text-[11px] uppercase tracking-tight text-slate-700 group-hover:text-slate-900">${name}</p>
                        <p class="text-[10px] font-bold text-primary uppercase tracking-widest">${credits.toLocaleString()} ক্রেডিট</p>
                    </div>
                    <div class="bg-primary/5 p-2 rounded-lg group-hover:bg-primary/10 transition-colors">
                        <i data-lucide="trending-up" class="w-4 h-4 text-primary"></i>
                    </div>
                `;
                list.appendChild(item);
            }
            lucide.createIcons();
        };

        window.showView = (name) => {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('view-active'));
            const target = document.getElementById(`view-${name}`);
            if (target) target.classList.add('view-active');

            document.querySelectorAll('.nav-btn').forEach(b => {
                const active = b.dataset.view === name;
                b.classList.toggle('text-primary', active);
                b.classList.toggle('text-slate-300', !active);
            });

            if (name === 'leaderboard') {
                setTimeout(generateDemoUsers, 100);
            }
            lucide.createIcons();
        };

        async function startApp() {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else if (!auth.currentUser) {
                    await signInAnonymously(auth);
                }
            } catch (err) {
                console.warn("Auth warning:", err.message);
            }

            onAuthStateChanged(auth, user => {
                document.getElementById('loading-screen').classList.add('opacity-0');
                setTimeout(() => document.getElementById('loading-screen').classList.add('hidden'), 500);

                if (user && !user.isAnonymous) {
                    document.getElementById('auth-shell').classList.add('hidden');
                    document.getElementById('app-shell').classList.remove('hidden');

                    const userDocRef = doc(db, 'artifacts', appId, 'users', user.uid, 'profile', 'info');
                    onSnapshot(userDocRef, snap => {
                        if (snap.exists()) {
                            const d = snap.data();
                            document.getElementById('header-credits').textContent = (d.credits || 0).toLocaleString();
                            document.getElementById('home-credits').textContent = (d.credits || 0).toLocaleString();
                            document.getElementById('stats-credits').textContent = (d.credits || 0).toLocaleString();
                            document.getElementById('stats-ads').textContent = d.adsWatched || 0;
                            document.getElementById('profile-level').textContent = d.level || 24;

                            const userName = d.fullName || user.displayName || 'G-Father User';
                            document.getElementById('profile-name').textContent = userName.toString().toUpperCase();
                            const userEmail = user.email || 'N/A';
                            document.getElementById('profile-email').textContent = userEmail.toString().toUpperCase();
                        }
                    });
                    window.showView('home');
                } else {
                    document.getElementById('auth-shell').classList.remove('hidden');
                    document.getElementById('app-shell').classList.add('hidden');
                }
            });
        }

        document.getElementById('auth-form').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('auth-submit-btn');
            const errorBox = document.getElementById('auth-error');
            errorBox.classList.add('hidden');
            btn.disabled = true;

            try {
                const email = document.getElementById('auth-email').value;
                const pass = document.getElementById('auth-password').value;

                if (isSignupMode) {
                    const cred = await createUserWithEmailAndPassword(auth, email, pass);
                    const name = document.getElementById('auth-name').value;
                    await updateProfile(cred.user, { displayName: name });
                    await setDoc(doc(db, 'artifacts', appId, 'users', cred.user.uid, 'profile', 'info'), {
                        fullName: name,
                        email: email,
                        credits: 150,
                        adsWatched: 0,
                        level: 1,
                        createdAt: new Date().toISOString()
                    });
                } else {
                    await signInWithEmailAndPassword(auth, email, pass);
                }
            } catch (err) {
                errorBox.classList.remove('hidden');
                document.getElementById('error-message').textContent = "ইমেইল বা পাসওয়ার্ড ভুল হয়েছে।";
                btn.disabled = false;
            }
        };

        window.handleLogout = () => signOut(auth).then(() => location.reload());

        // ── TRANSLATIONS ──────────────────────────────────────────
        const translations = {
            bn: {
                balance: 'আপনার ব্যালেন্স',
                bonusCenter: 'বোনাস সেন্টার',
                earnBtn: 'পয়েন্ট নিন',
                earnSub: '+১ ক্রেডিট',
                adStatus: 'সরাসরি ক্রেডিট সংগ্রহ করুন',
                gmailTitle: 'Gmail Free Tool',
                gmailDesc: 'জিমেইল তৈরি করার জন্য নিচের বাটনে ক্লিক করুন। প্রতি ক্রিয়েশনে পাবেন আকর্ষণীয় রিওয়ার্ড।',
                gmailBtn: 'Gmail Create',
                leaderTitle: 'লিডারবোর্ড',
                leaderSub: 'সেরা ১০০ জন ব্যবহারকারী',
                totalCredits: 'মোট ক্রেডিট',
                activity: 'অ্যাক্টিভিটি',
                logout: 'লগআউট',
                navEarn: 'EARN', navWork: 'WORK', navRank: 'RANK', navUser: 'USER',
                loginTitle: 'লগইন করুন',
                signupTitle: 'অ্যাকাউন্ট খুলুন',
                loginBtn: 'প্রবেশ করুন',
                signupBtn: 'রেজিস্ট্রেশন',
                toggleLogin: 'ইতিমধ্যে অ্যাকাউন্ট আছে? লগইন করুন',
                toggleSignup: 'অ্যাকাউন্ট নেই? নতুন তৈরি করুন',
                namePlaceholder: 'নাম লিখুন',
                emailLabel: 'ইমেইল ঠিকানা',
                passLabel: 'পাসওয়ার্ড',
                nameLabel: 'আপনার নাম',
                authDesc: 'আপনার অ্যাকাউন্ট তৈরি করার বিশ্বস্ত অ্যাপ',
                wrongPass: 'ইমেইল বা পাসওয়ার্ড ভুল হয়েছে।',
                needCredits: 'Gmail তৈরি করতে কমপক্ষে ২ ক্রেডিট লাগবে।\nআপনার বর্তমান ক্রেডিট: ',
            },
            en: {
                balance: 'Your Balance',
                bonusCenter: 'Bonus Center',
                earnBtn: 'Get Points',
                earnSub: '+1 Credit',
                adStatus: 'Click to earn credits',
                gmailTitle: 'Gmail Free Tool',
                gmailDesc: 'Click the button below to create a Gmail account. Earn rewards for each creation.',
                gmailBtn: 'Gmail Create',
                leaderTitle: 'Leaderboard',
                leaderSub: 'Top 100 Users',
                totalCredits: 'Total Credits',
                activity: 'Activity',
                logout: 'LOGOUT',
                navEarn: 'EARN', navWork: 'WORK', navRank: 'RANK', navUser: 'USER',
                loginTitle: 'Login',
                signupTitle: 'Create Account',
                loginBtn: 'Sign In',
                signupBtn: 'Register',
                toggleLogin: 'Already have an account? Login',
                toggleSignup: "Don't have an account? Create one",
                namePlaceholder: 'Enter your name',
                emailLabel: 'Email Address',
                passLabel: 'Password',
                nameLabel: 'Your Name',
                authDesc: 'The trusted app for creating your account',
                wrongPass: 'Incorrect email or password.',
                needCredits: 'You need at least 2 credits to create Gmail.\nYour credits: ',
            },
            ru: {
                balance: 'Ваш баланс',
                bonusCenter: 'Бонус центр',
                earnBtn: 'Получить очки',
                earnSub: '+1 Кредит',
                adStatus: 'Нажмите для получения кредитов',
                gmailTitle: 'Gmail Free Tool',
                gmailDesc: 'Нажмите кнопку ниже, чтобы создать аккаунт Gmail. Зарабатывайте награды за каждое создание.',
                gmailBtn: 'Создать Gmail',
                leaderTitle: 'Таблица лидеров',
                leaderSub: 'Топ 100 пользователей',
                totalCredits: 'Всего кредитов',
                activity: 'Активность',
                logout: 'ВЫХОД',
                navEarn: 'ЗАРАБОТОК', navWork: 'РАБОТА', navRank: 'РЕЙТИНГ', navUser: 'ПРОФИЛЬ',
                loginTitle: 'Войти',
                signupTitle: 'Создать аккаунт',
                loginBtn: 'Войти',
                signupBtn: 'Регистрация',
                toggleLogin: 'Уже есть аккаунт? Войти',
                toggleSignup: 'Нет аккаунта? Создать',
                namePlaceholder: 'Введите имя',
                emailLabel: 'Электронная почта',
                passLabel: 'Пароль',
                nameLabel: 'Ваше имя',
                authDesc: 'Надёжное приложение для создания аккаунта',
                wrongPass: 'Неверный email или пароль.',
                needCredits: 'Вам нужно минимум 2 кредита для создания Gmail.\nВаши кредиты: ',
            }
        };

        let currentLang = localStorage.getItem('lang') || 'bn';

        window.setLang = (lang) => {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            const t = translations[lang];
            // Header
            document.querySelectorAll('.nav-earn').forEach(e => e.textContent = t.navEarn);
            document.querySelectorAll('.nav-work').forEach(e => e.textContent = t.navWork);
            document.querySelectorAll('.nav-rank').forEach(e => e.textContent = t.navRank);
            document.querySelectorAll('.nav-user').forEach(e => e.textContent = t.navUser);
            // Earn view
            const bc = document.getElementById('bonus-center-label');
            if (bc) bc.textContent = t.bonusCenter;
            const eb = document.getElementById('earn-btn-label');
            if (eb) eb.textContent = t.earnBtn;
            const es = document.getElementById('earn-btn-sub');
            if (es) es.textContent = t.earnSub;
            const bal = document.getElementById('balance-label');
            if (bal) bal.textContent = t.balance;
            // Browser view
            const gt = document.getElementById('gmail-tool-title');
            if (gt) gt.textContent = t.gmailTitle;
            const gd = document.getElementById('gmail-tool-desc');
            if (gd) gd.textContent = t.gmailDesc;
            const gb = document.getElementById('gmail-create-btn');
            if (gb) gb.textContent = t.gmailBtn;
            // Leaderboard
            const lt = document.getElementById('leader-title');
            if (lt) lt.textContent = t.leaderTitle;
            const ls = document.getElementById('leader-sub');
            if (ls) ls.textContent = t.leaderSub;
            // Profile
            const tc = document.getElementById('total-credits-label');
            if (tc) tc.textContent = t.totalCredits;
            const ac = document.getElementById('activity-label');
            if (ac) ac.textContent = t.activity;
            const lo = document.getElementById('logout-btn');
            if (lo) lo.textContent = t.logout;
            // Auth
            const ad = document.getElementById('auth-desc');
            if (ad) ad.textContent = t.authDesc;
            // Language button styles
            ['bn', 'en', 'ru'].forEach(l => {
                const btn = document.getElementById('lang-' + l);
                if (!btn) return;
                if (l === lang) {
                    btn.className = 'text-xs font-black px-2 py-1 rounded-lg border border-primary/30 bg-primary/10 text-primary transition-all';
                } else {
                    btn.className = 'text-xs font-black px-2 py-1 rounded-lg border border-slate-200 text-slate-400 transition-all';
                }
            });
            // Update isSignupMode-aware texts
            const authTitle = document.getElementById('auth-title');
            if (authTitle) authTitle.textContent = isSignupMode ? t.signupTitle : t.loginTitle;
            const authBtnText = document.getElementById('auth-btn-text');
            if (authBtnText) authBtnText.textContent = isSignupMode ? t.signupBtn : t.loginBtn;
            const authToggleBtn = document.getElementById('auth-toggle-btn');
            if (authToggleBtn) authToggleBtn.textContent = isSignupMode ? t.toggleLogin : t.toggleSignup;
            const adStatus = document.getElementById('ad-status');
            if (adStatus) adStatus.textContent = t.adStatus;
        };

        startApp();
        lucide.createIcons();
        // Apply saved language on load
        setTimeout(() => window.setLang(currentLang), 300);

    </script>
</body>

</html>